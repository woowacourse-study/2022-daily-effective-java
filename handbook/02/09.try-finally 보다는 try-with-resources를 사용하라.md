# ìì›ì„ ì§ì ‘ ë‹«ì„ ê²½ìš° try-finally ë³´ë‹¤ëŠ” try-with-resourcesë¥¼ ì‚¬ìš©í•˜ë¼
`ì—˜ë¦¬`
> ğŸ’¡ `close` ë©”ì„œë“œë¥¼ í˜¸ì¶œí•´ ì§ì ‘ ë‹«ì•„ì¤˜ì•¼í•˜ëŠ” ìì›ì— `try-with-resources`ë¥¼ ì ìš©í•´ ì•ˆì „í•˜ê²Œ ë‹«ì•„ì£¼ì!!  
- ì˜ˆ) InputStream, OutputStream, java.sql.Connection ë“±  
- **ìì›ì„ ë‹«ì§€ ì•Šìœ¼ë©´ ì„±ëŠ¥ ë¬¸ì œë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆë‹¤!!**

## try-finally (Java7 ì´ì „)
```java
ë³€ìˆ˜1 = null;
ë³€ìˆ˜2 = null;
try {
   ë³€ìˆ˜1 = new ìì›ê°ì²´1();
   ë³€ìˆ˜2 = new ìì›ê°ì²´2();
   ë³€ìˆ˜1.ì‘ì—…();
   ë³€ìˆ˜2.ì‘ì—…();
   ...
} finally {
   if (ë³€ìˆ˜1 != null) ë³€ìˆ˜1.close();
   if (ë³€ìˆ˜2 != null) ë³€ìˆ˜2.close();
}
```
- ì–´ë–¤ ê²½ìš°ì—ë„ ìì›ì„ ë°˜ë‚©í•˜ë„ë¡ êµ¬í˜„í•˜ê¸°ìœ„í•´ `fianlly`ë¥¼ ì‚¬ìš©í•˜ê²Œ ëœë‹¤.
- `null` ì—¬ë¶€ë¥¼ ì¶”ê°€ë¡œ ê²€ì‚¬í•´ì•¼í•œë‹¤.
- `close` í•´ì£¼ëŠ” ê±¸ ìŠìœ¼ë©´ ê·¸ëƒ¥ ë..
<details> 
<summary>ë””ë²„ê¹…ì˜ ì–´ë ¤ì›€</summary> 

- ì˜ˆì™¸ëŠ” `try ë¸”ë¡`ê³¼ `finally ë¸”ë¡` ëª¨ë‘ì—ì„œ ë°œìƒí•  ìˆ˜ ìˆë‹¤.
- ì´ëŸ´ ê²½ìš° `fianlly ë¸”ë¡`ì—ì„œ ë°œìƒí•œ ì˜ˆì™¸ë§Œ ë‚¨ê²Œë˜ê³  `try ë¸”ë¡`ì—ì„œ ë°œìƒí•œ ì˜ˆì™¸ëŠ” ì•Œ ìˆ˜ ì—†ê²Œ ëœë‹¤.   

![image](https://user-images.githubusercontent.com/45311765/158436879-f1560115-accb-4548-a2c4-03645842c2ab.png)
```java
@Test
void throwExceptionTryFinally() throws IOException {
FileInputStream is = null;
BufferedInputStream bis = null;
try {
is = new FileInputStream("/Users/ellie/MyData/woowacourse/file.txt");
bis = new BufferedInputStream(is);
int data = -1;
while ((data = bis.read()) != -1) {
System.out.print((char) data);
}
throw new IOException("tryì—ì„œ ì—ëŸ¬ ë°œìƒ");
} finally {
if (is != null) {
is.close();
}
if (bis != null) {
bis.close();
}
throw new IOException("finallyì—ì„œ ì—ëŸ¬ ë°œìƒ");
}
}
```
</details>

## try-with-resources (Java7 ì´í›„)
```java
try (ë³€ìˆ˜1 = new ìì›ê°ì²´1();
     ë³€ìˆ˜2 = new ìì›ê°ì²´2()) {
    ...
}
```
try-with-resourcesëŠ” `try(...)`ì—ì„œ ì„ ì–¸ëœ ê°ì²´ë“¤ì— ëŒ€í•´ `try`ê°€ ì¢…ë£Œë  ë•Œ **ìë™ìœ¼ë¡œ `close`ë¥¼ í˜¸ì¶œí•˜ì—¬ ìì›ì„ í•´ì œí•´ì£¼ëŠ” ê¸°ëŠ¥ì„ ì œê³µ**í•œë‹¤.

- Java7ë¶€í„° ì œê³µí•œë‹¤.
- ì´ë•Œ í•´ì œí•˜ë ¤ëŠ” ìì›ì˜ ê°ì²´ì—ëŠ” `AutoCloseable` ì¸í„°í˜ì´ìŠ¤ê°€ êµ¬í˜„ë˜ì–´ ìˆì–´ì•¼í•œë‹¤. (ì•„ì´í…œ8 ì°¸ê³ )

ìœ„ì˜ ê²½ìš°ê°€ ì•„ë‹ˆë¼ë©´ ë¬´ì¡°ê±´ try-with-resourcesë¥¼ ì‚¬ìš©í•˜ì!!

- ì§§ê³  ì½ê¸° ìˆ˜ì›”í•´ì§„ë‹¤.
- `close`ë¥¼ ìŠì„ ì¼ì´ ì—†ë‹¤.
- ë¬¸ì œë¥¼ ì§„ë‹¨í•˜ê¸° ì¢‹ì•„ì§„ë‹¤.
<details> 
<summary>ë””ë²„ê¹…ì˜ ì–´ë ¤ì›€ í•´ì†Œ</summary> 

- `try ë¸”ë¡`ê³¼ `close`ì—ì„œ ëª¨ë‘ ì˜ˆì™¸ê°€ ë°œìƒí•  ìˆ˜ ìˆì§€ë§Œ **try ë¸”ë¡ì—ì„œ ë°œìƒí•œ ì˜ˆì™¸ê°€ ê¸°ë¡ëœë‹¤.**
- ì´ë•Œ closeì—ì„œ ë°œìƒí•œ ì˜ˆì™¸ëŠ” ìˆ¨ê²¨ì§€ë©°, ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤ì— â€œSuppressed(ìˆ¨ê²¨ì§)â€ í‚¤ì›Œë“œë¡œ ì¶œë ¥ëœë‹¤.

![image](https://user-images.githubusercontent.com/45311765/158437955-41574ee1-af69-4bd1-876e-06ca64b13303.png)
```java
public class CustomResource implements AutoCloseable {

  public void doSomething() {
    System.out.println("Do something...");
  }

  @Override
  public void close() {
    System.out.println("CustomResource.close() is called");
    throw new IllegalArgumentException("closeì—ì„œ ì—ëŸ¬ ë°œìƒ");
  }
}
```
```java
@Test
void throwExceptionTryWithResources() {
    try (CustomResource cr = new CustomResource()) {
        cr.doSomething();
        throw new IOException("tryì—ì„œ ì—ëŸ¬ ë°œìƒ");
    } catch (Exception e) {
        e.printStackTrace();
    }
}
```
</details>

** IntelliJì—ì„œë„ ë‹¤ìŒê³¼ ê°™ì´ try-fianllyë¡œ ìì›ì„ í•´ì œí•  ê²½ìš° ê²½ê³ ë¥¼ ë„ìš°ë©°, try-with-rewourcesë¡œì˜ ë³€ê²½ì„ ê¶Œì¥í•˜ê³  ìˆë‹¤.
![image](https://user-images.githubusercontent.com/45311765/158437340-c0f5226c-e26e-4fc5-a500-0fe71848f38b.png)

## Ref.
- https://devlog-wjdrbs96.tistory.com/116
- https://codechacha.com/ko/java-try-with-resources/
